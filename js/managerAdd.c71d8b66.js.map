{"version":3,"file":"js/managerAdd.c71d8b66.js","mappings":"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","sources":["webpack://command-manager/./src/api/index.js","webpack://command-manager/./src/config/index.js","webpack://command-manager/./src/utils/index.js","webpack://command-manager/./src/views/manager/common.js","webpack://command-manager/./node_modules/uuid/dist/esm-browser/rng.js","webpack://command-manager/./node_modules/uuid/dist/esm-browser/regex.js","webpack://command-manager/./node_modules/uuid/dist/esm-browser/validate.js","webpack://command-manager/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://command-manager/./node_modules/uuid/dist/esm-browser/v4.js","webpack://command-manager/./src/views/manager/add.vue","webpack://command-manager/./src/views/manager/add.vue?c092"],"sourcesContent":["import { fetchApi } from '@/utils'\r\nexport default {\r\n  export (data) {\r\n    return fetchApi('export', 'post', data)\r\n  },\r\n  open (data) {\r\n    return fetchApi('open', 'post', data)\r\n  }\r\n}\r\n","export default {\r\n  baseUrl: 'http://localhost:27001/'\r\n}\r\n","import config from '@/config'\r\n\r\nexport const fetchApi = (url, method, data) => {\r\n  return new Promise((resolve, reject) => {\r\n    fetch(`${config.baseUrl}${url}`, {\r\n      method,\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        if (res.code === 200) {\r\n          resolve(res)\r\n        }\r\n      })\r\n      .catch(reject)\r\n  })\r\n}\r\n\r\nexport const downloadFile = (content) => {\r\n  const link = document.createElement('a')\r\n  link.href = URL.createObjectURL(new Blob([content]))\r\n  link.download = 'manifest.json'\r\n  link.click()\r\n}\r\n","import { reactive } from 'vue'\r\nimport { useStorage } from '@vueuse/core'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nimport api from '@/api'\r\nimport { downloadFile } from '@/utils'\r\n\r\nconst state = reactive({\r\n  import: false,\r\n  export: false\r\n})\r\n\r\nexport const manifest = useStorage(\r\n  'manifest',\r\n  {},\r\n  localStorage,\r\n  { mergeDefaults: true }\r\n)\r\n\r\nexport const handleImportBefore = (event) => {\r\n  if (!state.import) {\r\n    ElMessageBox.confirm('导入配置后, 将会覆盖当前配置, 是否确认?', {\r\n      title: '确认导入配置',\r\n      type: 'warning'\r\n    }).then(() => {\r\n      state.import = true\r\n      event.target.click()\r\n    }).catch(console.log)\r\n    event.stopPropagation()\r\n  }\r\n}\r\nexport const handleImport = async (file) => {\r\n  try {\r\n    const data = await file.text()\r\n    // eslint-disable-next-line\r\n    manifest.value = eval('(' + data + ')')\r\n  } catch (err) {\r\n    console.warn(err)\r\n  }\r\n  return false\r\n}\r\n\r\nexport const handleExportBefore = (event) => {\r\n  if (!state.export) {\r\n    manifest.value.path && ElMessageBox.confirm(`是否要导出配置到 ${manifest.value.path}`, {\r\n      title: '确认导出配置',\r\n      type: 'warning'\r\n    }).then(() => {\r\n      state.export = true\r\n      handleExport()\r\n    }).catch(console.log)\r\n  } else {\r\n    handleExport()\r\n  }\r\n}\r\nexport const handleExport = () => {\r\n  api.export(manifest.value).then(() => {\r\n    ElMessage.success('导出成功')\r\n  })\r\n    .catch(() => {\r\n      downloadFile(JSON.stringify(manifest.value, null, 2))\r\n    })\r\n}\r\n\r\nexport const handleOutput = () => {\r\n  console.log(manifest.value)\r\n}\r\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","<template>\r\n  <el-form :model=\"form\" label-width=\"140px\">\r\n    <el-row>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"脚本名称\" prop=\"name\">\r\n          <el-input v-model=\"form.name\"></el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"脚本路径\" prop=\"path\">\r\n          <el-input v-model=\"form.path\"></el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"端口\" prop=\"port\">\r\n          <el-input v-model=\"form.port\"></el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"关键词(逗号分割)\" prop=\"keywords\">\r\n          <el-input v-model=\"form.keywords\"></el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"node版本\" prop=\"nodeVersion\">\r\n          <el-input v-model=\"form.nodeVersion\"></el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"终端\" prop=\"terminal\">\r\n          <el-select placeholder=\"选择要使用的终端\" v-model=\"form.terminal\">\r\n            <el-option lable=\"cmd\" value=\"cmd\"></el-option>\r\n            <el-option lable=\"git\" value=\"git\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-col>\r\n      <el-col :span=\"8\">\r\n        <el-form-item label=\"默认运行\" prop=\"defaultRun\">\r\n          <el-switch v-model=\"form.defaultRun\" active-text=\"开启\" inactive-text=\"关闭\" />\r\n        </el-form-item>\r\n      </el-col>\r\n    </el-row>\r\n    <el-form-item label=\"命令组(换行符分割)\" prop=\"commandLines\">\r\n      <el-input v-model=\"form.commandLines\" type=\"textarea\" :rows=\"5\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"备注说明\" prop=\"desc\">\r\n      <el-input v-model=\"form.desc\" type=\"textarea\" :rows=\"5\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item>\r\n      <el-button type=\"primary\" @click=\"onConfirm\">{{ route.name === 'managerEdit' ? '修改' : '添加' }}</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n<script setup>\r\nimport { v4 as uuid } from 'uuid'\r\nimport { ref, defineProps, watch } from 'vue'\r\nimport { manifest } from './common'\r\nimport { useRoute } from 'vue-router'\r\nimport router from '@/router'\r\nconst route = useRoute()\r\nconst props = defineProps({\r\n  row: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst tableData = ref(manifest.value.commands)\r\nconst defaultRef = () => ({\r\n  form: Object.assign({\r\n    name: '',\r\n    path: '',\r\n    port: '',\r\n    nodeVersion: '',\r\n    keywords: '',\r\n    commandLines: '',\r\n    desc: '',\r\n    defaultRun: false\r\n  }, props.row.uuid ? props.row : {})\r\n})\r\nconst form = ref(defaultRef().form)\r\nconst onConfirm = () => {\r\n  if (props.active === 'edit' && props.row.uuid) {\r\n    tableData.value = tableData.value.map((item) => {\r\n      return item.uuid === props.row.uuid ? Object.assign({}, item, form.value) : item\r\n    })\r\n  } else {\r\n    tableData.value = tableData.value.concat(Object.assign({}, form.value, {\r\n      uuid: uuid()\r\n    }))\r\n    form.value = defaultRef().form\r\n  }\r\n  manifest.value = Object.assign({}, manifest.value, {\r\n    commands: tableData.value\r\n  })\r\n  setTimeout(() => {\r\n    router.replace({\r\n      name: 'managerList'\r\n    })\r\n  }, 500)\r\n}\r\nwatch(() => props.active, () => {\r\n  form.value = defaultRef().form\r\n})\r\nwatch(() => route.name, () => {\r\n  if (/^manager/.test(route.name)) {\r\n    if (route.query.uuid) {\r\n      form.value = tableData.value.find((item) => item.uuid === route.query.uuid)\r\n    } else {\r\n      form.value = defaultRef().form\r\n    }\r\n  }\r\n}, {\r\n  immediate: true\r\n})\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.el-form-item {\r\n\r\n  .el-select,\r\n  :deep(.el-input, .el-select) {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./add.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./add.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./add.vue?vue&type=style&index=0&id=df8cd03a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-df8cd03a\"]])\n\nexport default __exports__"],"names":["export","data","fetchApi","open","baseUrl","url","method","Promise","resolve","reject","fetch","config","headers","body","JSON","stringify","then","res","json","code","catch","downloadFile","content","link","document","createElement","href","URL","createObjectURL","Blob","download","click","state","reactive","import","manifest","useStorage","localStorage","mergeDefaults","handleImportBefore","event","ElMessageBox","confirm","title","type","target","console","log","stopPropagation","handleImport","async","file","text","value","eval","err","warn","handleExportBefore","handleExport","path","api","ElMessage","success","handleOutput","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","validate","uuid","REGEX","test","byteToHex","i","push","toString","substr","arr","offset","arguments","length","undefined","toLowerCase","TypeError","v4","options","buf","rnds","random","route","useRoute","tableData","ref","commands","defaultRef","form","Object","assign","name","port","nodeVersion","keywords","commandLines","desc","defaultRun","props","row","onConfirm","active","map","item","concat","setTimeout","router","replace","watch","query","find","immediate","__exports__"],"sourceRoot":""}