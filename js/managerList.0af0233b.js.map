{"version":3,"file":"js/managerList.0af0233b.js","mappings":"2IACA,KACEA,OAAQC,GACN,OAAOC,EAAAA,EAAAA,GAAS,SAAU,OAAQD,EACpC,EACAE,IAAAA,CAAMF,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,EACAG,IAAAA,CAAMH,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,EACAI,IAAAA,CAAMJ,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,E,0GCbF,GACEK,QAAS,2BCCJ,MAAMJ,EAAWA,CAACK,EAAKC,EAAQP,IAC7B,IAAIQ,SAAQ,CAACC,EAASC,KAC3BC,MAAO,GAAEC,EAAOP,UAAUC,IAAO,CAC/BC,SACAM,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUhB,KAEpBiB,MAAMC,GAAQA,EAAIC,SAClBF,MAAMC,IACY,MAAbA,EAAIE,KACNX,EAAQS,GAERR,EAAOQ,EACT,IAEDG,MAAMX,EAAO,IAIPY,EAAgBC,IAC3B,MAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAOC,IAAIC,gBAAgB,IAAIC,KAAK,CAACP,KAC1CC,EAAKO,SAAW,gBAChBP,EAAKQ,OAAO,C,spBCpBd,MAAMC,OAAQC,EAAAA,iCAAAA,IAAS,CACrBC,QAAQ,EACRpC,QAAQ,IAGGqC,UAAWC,EAAAA,0CAAAA,KACtB,WACA,CAAC,EACDC,aACA,CAAEC,eAAe,IAGNC,mBAAsBC,IAC5BR,MAAME,SACTO,0CAAAA,EAAaC,QAAQ,yBAA0B,CAC7CC,MAAO,SACPC,KAAM,YACL5B,MAAK,KACNgB,MAAME,QAAS,EACfM,EAAMK,OAAOd,OAAO,IACnBX,MAAM0B,QAAQC,KACjBP,EAAMQ,kBACR,EAEWC,aAAeC,aAC1B,IACE,MAAMnD,WAAaoD,KAAKC,OAExBjB,SAASkB,MAAQC,KAAK,IAAMvD,KAAO,IACrC,CAAE,MAAOwD,KACPT,QAAQU,KAAKD,IACf,CACA,OAAO,CAAK,EAGDE,mBAAsBjB,IAC5BR,MAAMlC,OAcT4D,eAbIvB,SAASkB,MAAMM,KACjBlB,0CAAAA,EAAaC,QAAS,YAAWP,SAASkB,MAAMM,OAAQ,CACtDhB,MAAO,SACPC,KAAM,YACL5B,MAAK,KACNgB,MAAMlC,QAAS,EACf4D,cAAc,IACbtC,MAAM0B,QAAQC,MAEjBf,MAAMlC,QAAS,EACf4D,eAIJ,EAEWA,aAAeA,IACnBE,kCAAAA,EAAI9D,OAAOqC,SAASkB,OAAOrC,MAAK,KACrC6C,0CAAAA,GAAUC,QAAQ,OAAO,IAExB1C,OAAM,MACLC,EAAAA,oCAAAA,GAAaP,KAAKC,UAAUoB,SAASkB,MAAO,KAAM,GAAG,IAI9CU,aAAeA,KAC1BjB,QAAQC,IAAIZ,SAASkB,MAAM,C,+KCjC7B,MAAMW,EAAYA,CAACpB,EAAMqB,KACvBC,EAAAA,EAAOC,KAAK,CACVC,KAAMxB,EACNyB,MAAO,CACLC,KAAML,EAAIK,OAEZ,EAEEC,EAAcN,IAClBL,EAAAA,EAAI3D,KAAKgE,EAAI,EAETO,EAAcP,IAClBL,EAAAA,EAAI1D,KAAK+D,EAAI,EAETQ,EAAcR,IAClBL,EAAAA,EAAIzD,KAAK8D,EAAI,EAETS,EAAeA,CAACT,EAAKU,KACzBlC,EAAAA,EAAaC,QAAS,QAAOuB,EAAIG,WAAY,CAC3CzB,MAAO,OACPC,KAAM,YACL5B,MAAK,KACN4D,EAAUvB,MAAMwB,OAAOF,EAAO,IAC7BvD,MAAM0B,QAAQC,IAAI,EAEjB+B,EAAaA,CAACb,EAAKc,KACvBC,OAAO/E,KAAM,oBAAmB8E,IAAO,EAEnCH,GAAYK,EAAAA,EAAAA,IAAI9C,EAAAA,GAASkB,MAAM6B,U,kwDC3DrC,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://command-manager/./src/api/index.js","webpack://command-manager/./src/config/index.js","webpack://command-manager/./src/utils/index.js","webpack://command-manager/./src/views/manager/common.js","webpack://command-manager/./src/views/manager/list.vue","webpack://command-manager/./src/views/manager/list.vue?7611"],"sourcesContent":["import { fetchApi } from '@/utils'\r\nexport default {\r\n  export (data) {\r\n    return fetchApi('export', 'post', data)\r\n  },\r\n  open (data) {\r\n    return fetchApi('open', 'post', data)\r\n  },\r\n  exec (data) {\r\n    return fetchApi('exec', 'post', data)\r\n  },\r\n  stop (data) {\r\n    return fetchApi('stop', 'post', data)\r\n  }\r\n}\r\n","export default {\r\n  baseUrl: 'http://localhost:27001/'\r\n}\r\n","import config from '@/config'\r\n\r\nexport const fetchApi = (url, method, data) => {\r\n  return new Promise((resolve, reject) => {\r\n    fetch(`${config.baseUrl}${url}`, {\r\n      method,\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        if (res.code === 200) {\r\n          resolve(res)\r\n        } else {\r\n          reject(res)\r\n        }\r\n      })\r\n      .catch(reject)\r\n  })\r\n}\r\n\r\nexport const downloadFile = (content) => {\r\n  const link = document.createElement('a')\r\n  link.href = URL.createObjectURL(new Blob([content]))\r\n  link.download = 'manifest.json'\r\n  link.click()\r\n}\r\n","import { reactive } from 'vue'\r\nimport { useStorage } from '@vueuse/core'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nimport api from '@/api'\r\nimport { downloadFile } from '@/utils'\r\n\r\nconst state = reactive({\r\n  import: false,\r\n  export: false\r\n})\r\n\r\nexport const manifest = useStorage(\r\n  'manifest',\r\n  {},\r\n  localStorage,\r\n  { mergeDefaults: true }\r\n)\r\n\r\nexport const handleImportBefore = (event) => {\r\n  if (!state.import) {\r\n    ElMessageBox.confirm('导入配置后, 将会覆盖当前配置, 是否确认?', {\r\n      title: '确认导入配置',\r\n      type: 'warning'\r\n    }).then(() => {\r\n      state.import = true\r\n      event.target.click()\r\n    }).catch(console.log)\r\n    event.stopPropagation()\r\n  }\r\n}\r\nexport const handleImport = async (file) => {\r\n  try {\r\n    const data = await file.text()\r\n    // eslint-disable-next-line\r\n    manifest.value = eval('(' + data + ')')\r\n  } catch (err) {\r\n    console.warn(err)\r\n  }\r\n  return false\r\n}\r\n\r\nexport const handleExportBefore = (event) => {\r\n  if (!state.export) {\r\n    if (manifest.value.path) {\r\n      ElMessageBox.confirm(`是否要导出配置到 ${manifest.value.path}`, {\r\n        title: '确认导出配置',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        state.export = true\r\n        handleExport()\r\n      }).catch(console.log)\r\n    } else {\r\n      state.export = true\r\n      handleExport()\r\n    }\r\n  } else {\r\n    handleExport()\r\n  }\r\n}\r\nexport const handleExport = () => {\r\n  return api.export(manifest.value).then(() => {\r\n    ElMessage.success('导出成功')\r\n  })\r\n    .catch(() => {\r\n      downloadFile(JSON.stringify(manifest.value, null, 2))\r\n    })\r\n}\r\n\r\nexport const handleOutput = () => {\r\n  console.log(manifest.value)\r\n}\r\n","<template>\r\n  <el-table :data=\"tableData\" @row-dblclick=\"row => handleRow('managerEdit', row)\" border>\r\n    <el-table-column type=\"index\" label=\"序号\" width=\"60\" />\r\n    <el-table-column prop=\"name\" label=\"名称\" width=\"120\" />\r\n    <el-table-column prop=\"port\" label=\"端口\">\r\n      <template #default=\"{ row }\">\r\n        <template v-for=\"(port, index) in row.port.split(',')\">\r\n          <el-button v-if=\"port\" :key=\"index\" type=\"primary\" size=\"small\" @click=\"toPortLink(row, port)\" plain>\r\n            {{ port }}\r\n          </el-button>\r\n        </template>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column prop=\"nodeVersion\" label=\"node版本\" width=\"90\" />\r\n    <el-table-column prop=\"terminal\" label=\"终端\" width=\"64\" />\r\n    <el-table-column prop=\"path\" label=\"脚本路径\" />\r\n    <el-table-column prop=\"keywords\" label=\"关键词\" />\r\n    <el-table-column prop=\"desc\" label=\"备注\" />\r\n    <el-table-column prop=\"handle\" label=\"操作\" width=\"400\">\r\n      <template #default=\"{ row, $index }\">\r\n        <el-button size=\"small\" @click=\"handleOpen(row)\">打开路径</el-button>\r\n        <el-button type=\"danger\" size=\"small\" @click=\"handleExec(row)\">执行</el-button>\r\n        <el-button type=\"info\" size=\"small\" @click=\"handleStop(row)\">停止</el-button>\r\n        <el-button type=\"success\" size=\"small\" @click=\"handleRow('managerEdit', row)\">修改</el-button>\r\n        <el-button type=\"primary\" size=\"small\" @click=\"handleRow('managerCopy', row)\">复制</el-button>\r\n        <el-button type=\"warning\" size=\"small\" @click=\"handleDelete(row, $index)\">删除</el-button>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport api from '@/api'\r\nimport { manifest } from './common'\r\nimport router from '@/router'\r\nimport { ElMessageBox } from 'element-plus'\r\nconst handleRow = (type, row) => {\r\n  router.push({\r\n    name: type,\r\n    query: {\r\n      uuid: row.uuid\r\n    }\r\n  })\r\n}\r\nconst handleOpen = (row) => {\r\n  api.open(row)\r\n}\r\nconst handleExec = (row) => {\r\n  api.exec(row)\r\n}\r\nconst handleStop = (row) => {\r\n  api.stop(row)\r\n}\r\nconst handleDelete = (row, $index) => {\r\n  ElMessageBox.confirm(`是否删除 ${row.name} 命令？`, {\r\n    title: '删除确认',\r\n    type: 'warning'\r\n  }).then(() => {\r\n    tableData.value.splice($index)\r\n  }).catch(console.log)\r\n}\r\nconst toPortLink = (row, port) => {\r\n  window.open(`http://localhost:${port}`)\r\n}\r\nconst tableData = ref(manifest.value.commands)\r\n</script>\r\n<style scoped>\r\n.el-space {\r\n  margin-top: 20px;\r\n}\r\n</style>\r\n","import script from \"./list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./list.vue?vue&type=style&index=0&id=b54e6df0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b54e6df0\"]])\n\nexport default __exports__"],"names":["export","data","fetchApi","open","exec","stop","baseUrl","url","method","Promise","resolve","reject","fetch","config","headers","body","JSON","stringify","then","res","json","code","catch","downloadFile","content","link","document","createElement","href","URL","createObjectURL","Blob","download","click","state","reactive","import","manifest","useStorage","localStorage","mergeDefaults","handleImportBefore","event","ElMessageBox","confirm","title","type","target","console","log","stopPropagation","handleImport","async","file","text","value","eval","err","warn","handleExportBefore","handleExport","path","api","ElMessage","success","handleOutput","handleRow","row","router","push","name","query","uuid","handleOpen","handleExec","handleStop","handleDelete","$index","tableData","splice","toPortLink","port","window","ref","commands","__exports__"],"sourceRoot":""}