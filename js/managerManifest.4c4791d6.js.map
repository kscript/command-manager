{"version":3,"file":"js/managerManifest.4c4791d6.js","mappings":"2IACA,KACEA,OAAQC,GACN,OAAOC,EAAAA,EAAAA,GAAS,SAAU,OAAQD,EACpC,EACAE,IAAAA,CAAMF,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,EACAG,IAAAA,CAAMH,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,EACAI,IAAAA,CAAMJ,GACJ,OAAOC,EAAAA,EAAAA,GAAS,OAAQ,OAAQD,EAClC,E,0GCbF,GACEK,QAAS,2BCCJ,MAAMJ,EAAWA,CAACK,EAAKC,EAAQP,IAC7B,IAAIQ,SAAQ,CAACC,EAASC,KAC3BC,MAAO,GAAEC,EAAOP,UAAUC,IAAO,CAC/BC,SACAM,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAUhB,KAEpBiB,MAAMC,GAAQA,EAAIC,SAClBF,MAAMC,IACY,MAAbA,EAAIE,MACNX,EAAQS,EACV,IAEDG,MAAMX,EAAO,IAIPY,EAAgBC,IAC3B,MAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAOC,IAAIC,gBAAgB,IAAIC,KAAK,CAACP,KAC1CC,EAAKO,SAAW,gBAChBP,EAAKQ,OAAO,C,spBClBd,MAAMC,OAAQC,EAAAA,iCAAAA,IAAS,CACrBC,QAAQ,EACRpC,QAAQ,IAGGqC,UAAWC,EAAAA,0CAAAA,KACtB,WACA,CAAC,EACDC,aACA,CAAEC,eAAe,IAGNC,mBAAsBC,IAC5BR,MAAME,SACTO,0CAAAA,EAAaC,QAAQ,yBAA0B,CAC7CC,MAAO,SACPC,KAAM,YACL5B,MAAK,KACNgB,MAAME,QAAS,EACfM,EAAMK,OAAOd,OAAO,IACnBX,MAAM0B,QAAQC,KACjBP,EAAMQ,kBACR,EAEWC,aAAeC,aAC1B,IACE,MAAMnD,WAAaoD,KAAKC,OAExBjB,SAASkB,MAAQC,KAAK,IAAMvD,KAAO,IACrC,CAAE,MAAOwD,KACPT,QAAQU,KAAKD,IACf,CACA,OAAO,CAAK,EAGDE,mBAAsBjB,IAC5BR,MAAMlC,OAST4D,eARAvB,SAASkB,MAAMM,MAAQlB,0CAAAA,EAAaC,QAAS,YAAWP,SAASkB,MAAMM,OAAQ,CAC7EhB,MAAO,SACPC,KAAM,YACL5B,MAAK,KACNgB,MAAMlC,QAAS,EACf4D,cAAc,IACbtC,MAAM0B,QAAQC,IAGnB,EAEWW,aAAeA,KAC1BE,kCAAAA,EAAI9D,OAAOqC,SAASkB,OAAOrC,MAAK,KAC9B6C,0CAAAA,GAAUC,QAAQ,OAAO,IAExB1C,OAAM,MACLC,EAAAA,oCAAAA,GAAaP,KAAKC,UAAUoB,SAASkB,MAAO,KAAM,GAAG,GACrD,EAGOU,aAAeA,KAC1BjB,QAAQC,IAAIZ,SAASkB,MAAM,C,kXCH7B,MAAMT,GAAOoB,EAAAA,EAAAA,IAAI,UACXC,GAAQD,EAAAA,EAAAA,IAAI,CAAC,SAAU,SAAU,YACjCE,GAAWF,EAAAA,EAAAA,IAAI,IACfX,GAAQW,EAAAA,EAAAA,IAAI,IACZG,GAAmBH,EAAAA,EAAAA,KAAI,GACvBI,GAAYnC,EAAAA,EAAAA,IAAS,CAAC,GACtBoC,GAAOpC,EAAAA,EAAAA,IAAS,CAAC,GACjBqC,GAAWrC,EAAAA,EAAAA,IAAS,CAAC,GACrBsC,EAAkBA,KACtBJ,EAAiBd,OAAQ,CAAI,EAEzBmB,EAAYA,KACZ,CAAC,YAAYC,SAASP,EAASb,OACjCQ,EAAAA,GAAUa,MAAO,SAAQR,EAASb,SAG/Ba,EAASb,OAIde,EAAUF,EAASb,OAAS,CAAEsB,gBAASC,cAAQC,eAASjC,EAAKS,OAAOA,EAAMA,OAC1Ea,EAASb,MAAQA,EAAMA,MAAQ,GAC/Bc,EAAiBd,OAAQ,EACzBQ,EAAAA,GAAUC,QAAQ,SANhBD,EAAAA,GAAUa,MAAM,UAMO,EAErBI,EAAaA,KACjB3C,EAAAA,GAASkB,MAAQ0B,OAAOC,OAAO,CAAC,EAAG7C,EAAAA,GAASkB,MAAOgB,EAAK,EAEpDY,EAAgBC,IACF,SAAdA,EAAKC,KAIT1C,EAAAA,EAAaC,QAAS,SAAQwC,EAAKC,QAAQnE,MAAK,YACvCsD,EAASY,EAAKC,aACdf,EAAUc,EAAKC,KAAK,IAC1B/D,MAAM0B,QAAQC,KANfc,EAAAA,GAAUa,MAAM,aAMG,E,OAGvBU,EAAAA,EAAAA,KAAM,IAAM,CAACjD,EAAAA,GAASkB,MAAOa,EAASb,SAAQ,KAC5C,MAAMtD,EAAOgF,OAAOC,OAAO,CAAC,EAAGZ,EAAWjC,EAAAA,GAASkB,OACnD0B,OAAOM,KAAKtF,GAAMuF,SAAQC,IACxB,KAAMxF,EAAKwF,aAAgBR,QAAS,CAClC,MAAM1B,EAAQtD,EAAKwF,GACnBlB,EAAKkB,GAAOlC,EACZiB,EAASiB,GAAO,CAAEJ,KAAMI,EAAKlC,QAAOT,YAAaS,EACnD,KAEFtD,EAAK4D,KAAO5D,EAAK4D,MAAQ,EAAE,GAC1B,CACD6B,WAAW,I,suFC1Gb,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://command-manager/./src/api/index.js","webpack://command-manager/./src/config/index.js","webpack://command-manager/./src/utils/index.js","webpack://command-manager/./src/views/manager/common.js","webpack://command-manager/./src/views/manager/manifest.vue","webpack://command-manager/./src/views/manager/manifest.vue?0eac"],"sourcesContent":["import { fetchApi } from '@/utils'\r\nexport default {\r\n  export (data) {\r\n    return fetchApi('export', 'post', data)\r\n  },\r\n  open (data) {\r\n    return fetchApi('open', 'post', data)\r\n  },\r\n  exec (data) {\r\n    return fetchApi('exec', 'post', data)\r\n  },\r\n  stop (data) {\r\n    return fetchApi('stop', 'post', data)\r\n  }\r\n}\r\n","export default {\r\n  baseUrl: 'http://localhost:27001/'\r\n}\r\n","import config from '@/config'\r\n\r\nexport const fetchApi = (url, method, data) => {\r\n  return new Promise((resolve, reject) => {\r\n    fetch(`${config.baseUrl}${url}`, {\r\n      method,\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(data)\r\n    })\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        if (res.code === 200) {\r\n          resolve(res)\r\n        }\r\n      })\r\n      .catch(reject)\r\n  })\r\n}\r\n\r\nexport const downloadFile = (content) => {\r\n  const link = document.createElement('a')\r\n  link.href = URL.createObjectURL(new Blob([content]))\r\n  link.download = 'manifest.json'\r\n  link.click()\r\n}\r\n","import { reactive } from 'vue'\r\nimport { useStorage } from '@vueuse/core'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\nimport api from '@/api'\r\nimport { downloadFile } from '@/utils'\r\n\r\nconst state = reactive({\r\n  import: false,\r\n  export: false\r\n})\r\n\r\nexport const manifest = useStorage(\r\n  'manifest',\r\n  {},\r\n  localStorage,\r\n  { mergeDefaults: true }\r\n)\r\n\r\nexport const handleImportBefore = (event) => {\r\n  if (!state.import) {\r\n    ElMessageBox.confirm('导入配置后, 将会覆盖当前配置, 是否确认?', {\r\n      title: '确认导入配置',\r\n      type: 'warning'\r\n    }).then(() => {\r\n      state.import = true\r\n      event.target.click()\r\n    }).catch(console.log)\r\n    event.stopPropagation()\r\n  }\r\n}\r\nexport const handleImport = async (file) => {\r\n  try {\r\n    const data = await file.text()\r\n    // eslint-disable-next-line\r\n    manifest.value = eval('(' + data + ')')\r\n  } catch (err) {\r\n    console.warn(err)\r\n  }\r\n  return false\r\n}\r\n\r\nexport const handleExportBefore = (event) => {\r\n  if (!state.export) {\r\n    manifest.value.path && ElMessageBox.confirm(`是否要导出配置到 ${manifest.value.path}`, {\r\n      title: '确认导出配置',\r\n      type: 'warning'\r\n    }).then(() => {\r\n      state.export = true\r\n      handleExport()\r\n    }).catch(console.log)\r\n  } else {\r\n    handleExport()\r\n  }\r\n}\r\nexport const handleExport = () => {\r\n  api.export(manifest.value).then(() => {\r\n    ElMessage.success('导出成功')\r\n  })\r\n    .catch(() => {\r\n      downloadFile(JSON.stringify(manifest.value, null, 2))\r\n    })\r\n}\r\n\r\nexport const handleOutput = () => {\r\n  console.log(manifest.value)\r\n}\r\n","<template>\r\n  <el-container>\r\n    <el-main style=\"--el-main-padding: 0px 20px;\">\r\n      <el-form :model=\"form\" label-width=\"120px\">\r\n        <el-form-item v-for=\"item in baseForm\" :key=\"item.prop\" :label=\"item.prop\">\r\n          <el-input v-model=\"form[item.prop]\">\r\n            <template #append>\r\n              <el-button @click=\"handleRemove(item)\" icon>\r\n                <el-icon>\r\n                  <Minus />\r\n                </el-icon>\r\n              </el-button>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"success\" @click=\"handleAddDialog\">新增配置</el-button>\r\n          <el-button type=\"primary\" @click=\"handleSave\">暂存配置</el-button>\r\n          <span style=\"padding-right: 50px;\"></span>\r\n          <el-upload class=\"el-button el-button--text\" :before-upload=\"handleImport\" :show-file-list=\"false\">\r\n            <template #trigger>\r\n              <el-button type=\"warning\" @click=\"handleImportBefore\">\r\n                <span class=\"text--white\">\r\n                  导入配置\r\n                </span>\r\n              </el-button>\r\n            </template>\r\n          </el-upload>\r\n          <el-button type=\"danger\" @click=\"handleExportBefore\">导出配置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-main>\r\n    <el-aside width=\"300px\"></el-aside>\r\n    <el-dialog width=\"450px\" v-model=\"addDialogVisible\">\r\n      <template #header>新增配置</template>\r\n      <el-form :model=\"baseForm\">\r\n        <el-form-item>\r\n          <el-input placeholder=\"属性名\" v-model=\"property\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-input placeholder=\"属性值\" v-model=\"value\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-select placeholder=\"类型\" v-model=\"type\">\r\n            <el-option v-for=\"item in types\" :key=\"item\" :label=\"item\" :value=\"item\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"addDialogVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleAdd\">确 定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { reactive, watch, ref } from 'vue'\r\nimport { manifest, handleImport, handleImportBefore, handleExportBefore } from './common'\r\nconst type = ref('String')\r\nconst types = ref(['String', 'Number', 'Boolean'])\r\nconst property = ref('')\r\nconst value = ref('')\r\nconst addDialogVisible = ref(false)\r\nconst propertys = reactive({})\r\nconst form = reactive({})\r\nconst baseForm = reactive({})\r\nconst handleAddDialog = () => {\r\n  addDialogVisible.value = true\r\n}\r\nconst handleAdd = () => {\r\n  if (['commands'].includes(property.value)) {\r\n    ElMessage.error(`不能添加属性${property.value}`)\r\n    return\r\n  }\r\n  if (!property.value) {\r\n    ElMessage.error('不能添加空属性')\r\n    return\r\n  }\r\n  propertys[property.value] = { Boolean, String, Number }[type.value](value.value)\r\n  property.value = value.value = ''\r\n  addDialogVisible.value = false\r\n  ElMessage.success('添加成功')\r\n}\r\nconst handleSave = () => {\r\n  manifest.value = Object.assign({}, manifest.value, form)\r\n}\r\nconst handleRemove = (item) => {\r\n  if (item.prop === 'path') {\r\n    ElMessage.error('不能删除path属性')\r\n    return\r\n  }\r\n  ElMessageBox.confirm(`是否删除属性${item.prop}`).then(() => {\r\n    delete baseForm[item.prop]\r\n    delete propertys[item.prop]\r\n  }).catch(console.log)\r\n}\r\n\r\nwatch(() => [manifest.value, property.value], () => {\r\n  const data = Object.assign({}, propertys, manifest.value)\r\n  Object.keys(data).forEach(key => {\r\n    if (!(data[key] instanceof Object)) {\r\n      const value = data[key]\r\n      form[key] = value\r\n      baseForm[key] = { prop: key, value, type: typeof value }\r\n    }\r\n  })\r\n  data.path = data.path || ''\r\n}, {\r\n  immediate: true\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.el-form-item {\r\n\r\n  .el-select,\r\n  :deep(.el-input, .el-select) {\r\n    width: 100%;\r\n  }\r\n}\r\n\r\n.text--white {\r\n  color: #fff;\r\n\r\n  &:hover {\r\n    color: #fff;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./manifest.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./manifest.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./manifest.vue?vue&type=style&index=0&id=4240b540&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4240b540\"]])\n\nexport default __exports__"],"names":["export","data","fetchApi","open","exec","stop","baseUrl","url","method","Promise","resolve","reject","fetch","config","headers","body","JSON","stringify","then","res","json","code","catch","downloadFile","content","link","document","createElement","href","URL","createObjectURL","Blob","download","click","state","reactive","import","manifest","useStorage","localStorage","mergeDefaults","handleImportBefore","event","ElMessageBox","confirm","title","type","target","console","log","stopPropagation","handleImport","async","file","text","value","eval","err","warn","handleExportBefore","handleExport","path","api","ElMessage","success","handleOutput","ref","types","property","addDialogVisible","propertys","form","baseForm","handleAddDialog","handleAdd","includes","error","Boolean","String","Number","handleSave","Object","assign","handleRemove","item","prop","watch","keys","forEach","key","immediate","__exports__"],"sourceRoot":""}